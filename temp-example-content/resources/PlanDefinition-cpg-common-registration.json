{
  "resourceType": "PlanDefinition",
  "id": "cpg-common-registration",
  "action": [
    {
      "code": [
        {
          "coding": [
            {
              "code": "registration",
              "system": "http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-process-cs"
            }
          ]
        }
      ],
      "participant": [
        {
          "type": "patient",
          "role": {
            "coding": [
              {
                "code": "C000",
                "system": "http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-persona-cs"
              }
            ]
          }
        },
        {
          "type": "practitioner",
          "role": {
            "coding": [
              {
                "code": "W000",
                "system": "http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-persona-cs",
                "display": "Clerical support worker"
              }
            ]
          }
        }
      ],
      "action": [
        {
          "output": [
            {
              "type": "QuestionnaireResponse"
            }
          ],
          "participant": [
            {
              "type": "patient",
              "role": {
                "coding": [
                  {
                    "code": "C000",
                    "system": "http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-persona-cs"
                  }
                ]
              }
            }
          ],
          "title": "Gather identifying information",
          "definitionCanonical": "http://hl7.org/fhir/uv/cpg/Questionnaire/cpg-common-identity"
        },
        {
          "input": [
            {
              "codeFilter": [
                {
                  "code": [
                    {
                      "code": "http://hl7.org/fhir/uv/cpg/Questionnaire/cpg-common-identity",
                      "system": "urn:ietf:rfc:3986"
                    }
                  ],
                  "path": "questionnaire"
                }
              ],
              "type": "QuestionnaireResponse"
            }
          ],
          "output": [
            {
              "type": "Bundle"
            }
          ],
          "participant": [
            {
              "extension": [
                {
                  "url": "http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-participantCapabilityStatement",
                  "valueCanonical": "http://hl7.org/fhir/uv/cpg/CapabilityStatement/cpg-common-patient-registry"
                }
              ],
              "type": "device"
            }
          ],
          "title": "Patient match",
          "definitionUri": "http://hl7.org/fhir/OperationDefinition/Patient-match"
        },
        {
          "input": [
            {
              "type": "Bundle"
            }
          ],
          "output": [
            {
              "type": "Patient"
            }
          ],
          "participant": [
            {
              "type": "practitioner",
              "role": {
                "coding": [
                  {
                    "code": "W000",
                    "system": "http://hl7.org/fhir/uv/cpg/CodeSystem/cpg-common-persona-cs",
                    "display": "Clerical support worker"
                  }
                ]
              }
            }
          ],
          "title": "Resolve patient match results",
          "definitionCanonical": "http://hl7.org/fhir/uv/cpg/Questionnaire/cpg-common-resolve-patient-match"
        },
        {
          "condition": [
            {
              "expression": {
                "language": "text/cql",
                "expression": "not exists %input i where i is Patient"
              },
              "kind": "applicability"
            }
          ],
          "input": [
            {
              "type": "Patient"
            }
          ],
          "action": [
            {
              "input": [
                {
                  "codeFilter": [
                    {
                      "code": [
                        {
                          "code": "http://hl7.org/fhir/uv/cpg/Questionnaire/cpg-common-identity",
                          "system": "urn:ietf:rfc:3986"
                        }
                      ],
                      "path": "questionnaire"
                    }
                  ],
                  "type": "QuestionnaireResponse"
                }
              ],
              "output": [
                {
                  "type": "QuestionnaireResponse"
                }
              ],
              "title": "Gather patient information",
              "definitionCanonical": "http://hl7.org/fhir/uv/cpg/Questionnaire/cpg-common-patient-profile"
            },
            {
              "input": [
                {
                  "codeFilter": [
                    {
                      "code": [
                        {
                          "code": "http://hl7.org/fhir/uv/cpg/Questionnaire/cpg-common-patient-profile",
                          "system": "urn:ietf:rfc:3986"
                        }
                      ],
                      "path": "questionnaire"
                    }
                  ],
                  "type": "QuestionnaireResponse"
                }
              ],
              "output": [
                {
                  "type": "Patient"
                }
              ],
              "participant": [
                {
                  "extension": [
                    {
                      "url": "http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-participantCapabilityStatement",
                      "valueCanonical": "http://hl7.org/fhir/uv/cpg/CapabilityStatement/cpg-common-patient-registry"
                    }
                  ],
                  "type": "device"
                }
              ],
              "title": "Record patient data",
              "definitionUri": "http://hl7.org/fhir/restful-interaction#create"
            }
          ],
          "title": "New patient"
        },
        {
          "condition": [
            {
              "expression": {
                "language": "text/cql",
                "expression": "exists %input i where i is Patient"
              },
              "kind": "applicability"
            }
          ],
          "input": [
            {
              "type": "Patient"
            }
          ],
          "action": [
            {
              "input": [
                {
                  "codeFilter": [
                    {
                      "code": [
                        {
                          "code": "http://hl7.org/fhir/uv/cpg/Questionnaire/cpg-common-identity",
                          "system": "urn:ietf:rfc:3986"
                        }
                      ],
                      "path": "questionnaire"
                    }
                  ],
                  "type": "QuestionnaireResponse"
                }
              ],
              "output": [
                {
                  "type": "QuestionnaireResponse"
                }
              ],
              "title": "Ensure patient information is up to date",
              "definitionCanonical": "http://hl7.org/fhir/uv/cpg/Questionnaire/cpg-common-patient-profile"
            },
            {
              "input": [
                {
                  "codeFilter": [
                    {
                      "code": [
                        {
                          "code": "http://hl7.org/fhir/uv/cpg/Questionnaire/cpg-common-patient-profile",
                          "system": "urn:ietf:rfc:3986"
                        }
                      ],
                      "path": "questionnaire"
                    }
                  ],
                  "type": "QuestionnaireResponse"
                }
              ],
              "output": [
                {
                  "type": "Patient"
                }
              ],
              "participant": [
                {
                  "extension": [
                    {
                      "url": "http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-participantCapabilityStatement",
                      "valueCanonical": "http://hl7.org/fhir/uv/cpg/CapabilityStatement/cpg-common-patient-registry"
                    }
                  ],
                  "type": "device"
                }
              ],
              "title": "Record patient data",
              "definitionUri": "http://hl7.org/fhir/restful-interaction#update"
            }
          ],
          "title": "Existing patient"
        },
        {
          "input": [
            {
              "type": "Patient"
            }
          ],
          "output": [
            {
              "type": "Bundle"
            }
          ],
          "participant": [
            {
              "extension": [
                {
                  "url": "http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-participantCapabilityStatement",
                  "valueCanonical": "http://hl7.org/fhir/uv/cpg/CapabilityStatement/cpg-common-patient-registry"
                }
              ],
              "type": "device"
            }
          ],
          "title": "Patient summary lookup",
          "definitionUri": "http://hl7.org/fhir/uv/cpg/OperationDefinition/cpg-common-patient-summary"
        }
      ],
      "title": "Registration"
    }
  ],
  "url": "http://hl7.org/fhir/uv/cpg/PlanDefinition/cpg-common-registration",
  "status": "active",
  "name": "PlanDefinition_CPG_Common_Registration",
  "type": {
    "coding": [
      {
        "code": "workflow-definition",
        "system": "http://terminology.hl7.org/CodeSystem/plan-definition-type",
        "display": "Workflow Definition"
      }
    ]
  },
  "copyright": "Â© WHO 2019+."
}
